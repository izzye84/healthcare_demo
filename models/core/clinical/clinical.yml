version: 2

models:
  - name: condition
    description: A clinical condition, problem, diagnosis, or other event, situation, issue, or clinical concept that has risen to a level of concern.
    columns:
      - name: identifier
        description: Unique identifier for the distinct diagnosis for a patient
        tests:
          - not_null
          - unique

      - name: identifier_external_source
        description: Surrogate key made from various external source IDs
        tests:
          - not_null

      - name: encounter
        description: Encounter created as part of
        tests:
          - not_null

      - name: recorded_date
        description: Date record was first recorded

      - name: code
        description: Identification of the condition, problem or diagnosis
        tests:
          - not_null

      - name: code_system
        description: The coding system used to define the condition code (e.g. ICD-10)

      - name: onset_datetime
        description: Estimated or actual date, date-time the condition started
        tests:
          - is_date:
              date_format: yyyy-mm-dd

      - name: abatement_datetime
        description: Date when condition was in resolution/remission
        tests:
          - is_date:
              date_format: yyyy-mm-dd

      - name: client_id
        description: Strive client ID
        tests:
            - not_blank
            - accepted_values:
                values: ['ssm']

      - name: ingest_date
        description: Strive ingest date
        tests:
          - not_null
          - is_date:
              date_format: yyyy-mm-dd HH24:MI:SS

  - name: procedure
    description: An action that is or was performed on or for a patient. This can be a physical intervention like an operation, or less invasive like long term services, counseling, or hypnotherapy.
    columns:
      - name: identifier
        description: Unique identifier for the distinct diagnosis for a patient
        tests:
          - not_null
          - unique

      - name: identifier_external_source
        description: Surrogate key made from various external source IDs
        tests:
          - not_null

      - name: encounter
        description: Clinical encounter ID

      - name: code
        description: Procedure code
        tests:
          - not_null

      - name: code_system
        description: Code system that defines the procedure code

      - name: performed_datetime
        description: When the procedure was performed
        tests:
          - is_date:
              date_format: yyyy-mm-dd

      - name: client_id
        description: Strive client ID
        tests:
            - not_blank
            - accepted_values:
                values: ['ssm']

      - name: ingest_date
        description: Strive ingest date
        tests:
          - not_null
          - is_date:
              date_format: yyyy-mm-dd HH24:MI:SS
              date_type: timestamp

  - name: encounter
    description: An interaction between a patient and healthcare provider(s) for the purpose of providing healthcare service(s) or assessing the health status of a patient.
    columns:
      - name: identifier_encounter
        description: Identifier(s) by which this encounter is known.
        tests:
          - not_null
          - unique

      - name: identifier_external_encounter
        description: Surrogate key made from various external source IDs
        tests:
          - not_null

      - name: status
        description: planned, arrived, triaged, in-progress, onleave, finished, cancelled +.

      - name: type
        description: Specific type of encounter——clinical or claim.

      - name: service_type
        description: Broad categorization of the service that is to be provided (e.g. cardiology).

      - name: subject
        description: The patient or group present at the encounter.

      - name: period
        description: The start and end time of the encounter.

      - name: reason_code_text
        description: Reason the encounter takes place. For admissions, this can be used for a coded admission diagnosis.

      - name: service_provider
        description: The organization that is primarily responsible for this Encounter's services. This MAY be the same as the organization on the Patient record, however it could be different, such as if the actor performing the services was from an external organization (which may be billed seperately) for an external consultation. Refer to the example bundle showing an abbreviated set of Encounters for a colonoscopy.

      - name: client_id
        description: client_id

      - name: ingest_date
        description: ingest_date

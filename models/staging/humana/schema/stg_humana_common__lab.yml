version: 2

models:
  - name: stg_humana_common__lab
    description: Staging step for Humana lab in Common format

    columns:
      - name: sh_lab_item_id
        description: some_company Health unique lab item id generated by dbt function bt_utils.surrogate_key
        tests:
          - not_null
          - unique

      - name: patient_id
        description: Source values that identify a unique Patient, links to Patient file
        tests:
          - not_null

      - name: patient_account_number
        description: Patient account or medical record number from the EMR.

      - name: clinical_encounter_id
        description: EMR-generated Encounter ID, links to Clinical Encounter file

      - name: lab_id
        description: Group all lab or procedures together that came from one order
        tests:
          - not_null

      - name: lab_code_set
        description: Lab code set 

      - name: lab_code
        description: Lab code

      - name: lab_order_date
        description: Date the lab was ordered
        
      - name: lab_order_description
        description: Lab Name

      - name: service_code
        description: CPT code for procedure

      - name: service_code_modifier
        description: Modifier for procedure

      - name: service_code_type
        description: Serive code type Ex. CPT 

      - name: service_code_desc
        description: Service code description

      - name: result_description
        description: Lab measure

      - name: collection_date
        description: Date the lab was collected

      - name: result_date
        description: Date of the lab result
        tests:
          - is_date:
              date_format: yyyy-mm-dd   
      
      - name: result_text
        description: Only required if the result is a text value

      - name: result_numeric
        description: Only required if the result is a numeric value

      - name: result_pos_neg
        description: Binary input on a positive or negative test result

      - name: unit
        description: Ex, umol/L

      - name: reference_range
        description: Upper and lower limit, ex, "74-106"

      - name: abnormal_flag
        description: Indicates the normalcy status of the result, refer to standard interpretation codes on reference sheet Abnormal Flag
      
      - name: result_status
        description: Status of results for this order, refer to standard interpretation codes on reference sheet Result Status

      - name: ingest_timestamp_utc
        description: ingest timestamp in UTC

      - name: created_timestamp
        description: Created timestamp from source

      - name: modified_timestamp
        description: Modeified timestamp from source

version: 2

sources:
  - name: ssm_claims
    description: Source definition for SSM claims files
    schema: ssm
    tables:
      - name: member_eligibility
        description: SSM member eligibility data. 
        identifier: member_eligibility
        columns:
          - name: first_name
            description: Patient first name

          - name: middle_name
            description: Patient middle name

          - name: last_name
            description: Patient last name

          - name: social_security
            description: Patient SSN

          - name: dob
            description: Patient date of birth
            tests:
              - not_null
              - is_date:
                  date_format: yyyy-mm-dd

          - name: patient_id
            description: Patient member id
            tests:
              - not_null

          - name: relation
            description: Patient relationship to insurance policy holder

          - name: gender
            description: Patient gender
            tests:
              - accepted_values: 
                  values: ['M','F','U']

          - name: race
            description: Patient race

          - name: ethnic_group
            description: Patient ethnic group

          - name: primary_phone
            description: Patient primary phone number

          - name: primary_email
            description: Patient primary email address

          - name: address_line1
            description: Patient address line 1
            tests:
              - not_null:
                  severity: warn

          - name: address_line2
            description: Patient address line 2
            tests:
              - not_null
         
          - name: state
            description: Patient address state
            tests:
              - not_null:
                  severity: warn

          - name: zip
            description: Patient address zip code
            tests:
              - not_null:
                  severity: warn

          - name: eff_date
            description: Patient insurance coverage start date
            tests:
              - not_null
              - is_date:
                  date_format: yyyy-mm-dd

          - name: term_date
            description: Patient insurance coverage end date
            tests:
              - not_null
              - is_date:
                  date_format: yyyy-mm-dd

          - name: lob
            description: Patient insurance line of business
            tests:
              - not_null

          - name: contract
            description: Patient insurance contract
            tests:
              - not_null

          - name: insurance_name
            description: Patient insurance name
            tests:
              - not_null

          - name: primary_care_prov_id
            description: Patient's primary care provider id

      - name: member_crosswalk
        description: SSM member crosswalk. Used to link member ids to their enterprise mrn id
        identifier: member_crosswalk
        columns:
          - name: insurance_name
            description: Patient insurance name

          - name: lob
            description: Line of Business for Patient's insurance provider

          - name: payer_contract
            description: Payer contract

          - name: epic_pat_id
            description: Patient ID assigned by SSM's Epic EHR
            tests:
                - not_null

          - name: enterprise_mrn
            description: Patient's Enterprise Medical Record Number (MRN) assigned by SSM
            tests:
              - not_null
          - name: person_id
            description: Crosswalk person_id. This ID matches the `patient_id` in the `member_eligibility` source
            tests:
                - not_null